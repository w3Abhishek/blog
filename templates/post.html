{% extends 'base.html' %}

{% block title %}{{ post.title }} - Verma Notes{% endblock %}

{% block og_title %}{{ post.title }}{% endblock %}
{% block og_description %}{{ post.content | truncate(160) }}{% endblock %}
{% block og_type %}article{% endblock %}


{% block content %}
<article class="post-detail">
    <header class="post-header">
        <h1 class="post-title">{{ post.title }}</h1>
        <div class="post-meta">
            <span>{{ post.created_at[:10] }}</span> â€¢ <span>{{ post.category }}</span>
        </div>
    </header>

    <div class="post-content" id="viewer"></div>
    <textarea id="post-content-hidden" style="display:none;">{{ post.content | safe }}</textarea>

    {% if post.tags %}
    <div class="tags">
        {% for tag in post.tags %}
        <span class="tag">#{{ tag }}</span>
        {% endfor %}
    </div>
    {% endif %}

    <div class="post-navigation">
        {% if prev_post %}
        <a href="{{ url_for('post_detail', slug=prev_post.slug) }}" class="nav-link prev-post">
            <span class="nav-label">&larr; Previous Post</span>
            <span class="nav-title">{{ prev_post.title }}</span>
        </a>
        {% else %}
        <div class="nav-link disabled"></div>
        {% endif %}

        {% if next_post %}
        <a href="{{ url_for('post_detail', slug=next_post.slug) }}" class="nav-link next-post">
            <span class="nav-label">Next Post &rarr;</span>
            <span class="nav-title">{{ next_post.title }}</span>
        </a>
        {% else %}
        <div class="nav-link disabled"></div>
        {% endif %}
    </div>
</article>

<!-- Toast UI Viewer CSS -->
<link rel="stylesheet" href="https://uicdn.toast.com/editor/latest/toastui-editor.min.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism.min.css" />
<link rel="stylesheet"
    href="https://uicdn.toast.com/editor-plugin-code-syntax-highlight/latest/toastui-editor-plugin-code-syntax-highlight.min.css" />

<!-- Toast UI Viewer JS -->
<script src="https://uicdn.toast.com/editor/latest/toastui-editor-all.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/prism.min.js"></script>
<script
    src="https://uicdn.toast.com/editor-plugin-code-syntax-highlight/latest/toastui-editor-plugin-code-syntax-highlight-all.min.js"></script>

<script>
    const Viewer = toastui.Editor;
    const { codeSyntaxHighlight } = Viewer.plugin;
    const content = document.getElementById('post-content-hidden').value;

    const viewer = new Viewer.factory({
        el: document.querySelector('#viewer'),
        viewer: true,
        initialValue: content,
        plugins: [[codeSyntaxHighlight, { highlighter: Prism }]]
    });
</script>
{% endblock %}